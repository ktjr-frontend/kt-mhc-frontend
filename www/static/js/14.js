webpackJsonp([14],{"50pe":function(t,e,a){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"search-orders"},["popup"===t.openType?a("mt-header",{ref:"header",attrs:{title:"订单搜索"}},[a("div",{attrs:{slot:"left"},slot:"left"},[a("i",{staticClass:"p10 iconfont icon-guanbi",on:{click:function(e){e.preventDefault(),t.close(e)}}})])]):t._e(),a("header",{ref:"searchHeader",staticClass:"flex search-header"},[a("div",{staticClass:"search-input flex-item flex"},[a("i",{staticClass:"iconfont icon-sousuo"}),a("input",{staticClass:"flex-item",attrs:{type:"search",placeholder:"搜索"},domProps:{value:t.filter.value},on:{input:function(e){t.inputChange(e)},keyup:function(e){if(!("button"in e)&&13!==e.keyCode)return null;t.search(e)}}}),t.filter.value?a("i",{staticClass:"iconfont icon-qingchu",on:{click:t.clearSearch}}):t._e()]),a("button",{staticClass:"cancel-btn",on:{click:function(e){e.preventDefault(),t.cancel(e)}}},[t._v("取消")])]),a("section",{staticClass:"body"},[a("mt-navbar",{ref:"navBar",model:{value:t.filter.tabActive,callback:function(e){t.$set(t.filter,"tabActive",e)},expression:"filter.tabActive"}},[a("mt-tab-item",{attrs:{id:"vin"}},[t._v("车架号后6位")]),a("mt-tab-item",{attrs:{id:"modelName"}},[t._v("车型")]),a("mt-tab-item",{attrs:{id:"supplier"}},[t._v("供应商/经销商")])],1),a("mt-tab-container",{ref:"tabContainer",staticClass:"overflow-scroll",attrs:{swipeable:!0,"disable-swipe":"disable-swipe"},model:{value:t.filter.tabActive,callback:function(e){t.$set(t.filter,"tabActive",e)},expression:"filter.tabActive"}},t._l(["vin","modelName","supplier"],function(e){return a("mt-tab-container-item",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],attrs:{id:e,"infinite-scroll-disabled":"loading","infinite-scroll-distance":"10"}},[t.orderList.length?t._e():a("div",{staticClass:"no-data"},[a("i",{staticClass:"iconfont icon-car"}),a("p",[t._v("此搜索条件下没有结果")])]),t._l(t.orderList,function(e){return a("kt-card-item",{key:e.number,attrs:{"header-left":"订单号："+e.no,"header-right":t._f("moment")(e.applicationDate,"YYYY-MM-DD"),"arrow-visible":!0,arrow:t._f("orderStatusFormat")(e.status)}},[a("span",{staticClass:"color-primary",attrs:{slot:"arrow"},on:{click:function(a){t.goToDetail(e)}},slot:"arrow"},[t._v(t._s(t._f("orderStatusFormat")(e.status)))]),a("div",{staticClass:"content",on:{click:function(a){t.goToDetail(e)}}},[a("div",{staticClass:"content-row"},[t._v("垫资金额："+t._s(t._f("ktCurrency")(e.loanAmount)))]),a("div",{staticClass:"content-row"},[t._v("供应商："+t._s(e.supplier))]),a("div",{staticClass:"content-row flex"},[a("div",{staticClass:"content-left flex-item"},[t._v("订单描述："+t._s(e.brandName)+" "+t._s(e.seriesName)+" "+t._s(e.modelName))]),a("div",{staticClass:"content-right"},[t._v("共 "+t._s(e.vehicleNumber)+" 辆")])])]),t.canCloseStatus(e.status)||t.canEditStatus(e.status)?a("div",{staticClass:"buttons text-right ui-border-t",attrs:{slot:"footer"},slot:"footer"},[t.canCloseStatus(e.status)?a("button",{staticClass:"ui-border-radius",on:{click:function(a){t.closeOrder(e)}}},[t._v("关闭订单")]):t._e(),t.canEditStatus(e.status)?a("button",{staticClass:"ui-border-radius warning",on:{click:function(a){t.editOrder(e)}}},[t._v("编辑资料")]):t._e()]):t._e()])}),t.noMoreData?a("div",{staticClass:"no-more-data"},[a("small",[t._v("已经到底了")])]):t._e()],2)}))],1)],1)},staticRenderFns:[]},t.exports.render._withStripped=!0},KMIr:function(t,e,a){e=t.exports=a("FZ+f")(),e.push([t.i,".iconfont[data-v-f15f2e52]{width:30px;text-align:center}","",{version:3,sources:["/Users/luxueyan/work/kt-mhc-frontend/src/views/order/Search.vue"],names:[],mappings:"AACA,2BACE,WAAY,AACZ,iBAAmB,CACpB",file:"Search.vue",sourcesContent:["\n.iconfont[data-v-f15f2e52] {\n  width: 30px;\n  text-align: center;\n}\n"],sourceRoot:""}])},WC8o:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("Xxa5"),n=a.n(i),r=a("exGp"),s=a.n(r),o=a("Dd8w"),l=a.n(o),c=a("3dbI"),u=a("M4fF"),f=(a.n(u),a("p5Qk"));e.default={mixins:[f.a],props:{close:Function},mounted:function(){"page"===this.openType&&this.updateContainerHeight()},created:function(){this.filter=l()({},this.filter,this.$route.query),this._fetchData()},methods:{cancel:function(){this.close?this.close():this.routerBack()},clearSearch:function(){this.filter.value="",this.orderList=[],this.search()},updateContainerHeight:function(){var t=this,e=0,a=0,i=0,n=this.$root.$children[0];this.$nextTick(function(){e=t.$refs.searchHeader.getBoundingClientRect().height,a=t.$refs.navBar.$el.getBoundingClientRect().height,n.headerShow&&(i=n.$refs.header.$el.getBoundingClientRect().height),t.$refs.tabContainer.$el.style.height=window.innerHeight-a-i-e+"px"})},inputChange:function(t){this.filter.value=t.target.value,this.search()},loadMore:a.i(u.debounce)(function(){this._fetchData(!0)},500),search:function(){this.noMoreData=!1,this.$router.replace({name:this.$route.name,query:l()({},this.filter,{page:1})})},_fetchData:a.i(u.debounce)(function(){var t=s()(n.a.mark(function t(e){var a,i,r=this;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.filter.value){t.next=3;break}return this.orderList=[],t.abrupt("return");case 3:return this.filter.page=e?+this.filter.page+1:1,a={page:this.filter.page,size:this.filter.size},a[this.filter.tabActive]=this.filter.value,this.loading=!0,t.next=9,c.c.get(this.pruneParams(a)).then(function(t){return t.json()}).catch(function(t){throw r.loading=!1,t});case 9:i=t.sent,this.orderList=e?this.orderList.concat(i.data.pageData):i.data.pageData,i.data.pageData.length?this.loading=!1:(this.loading=!0,this.orderList.length&&(this.noMoreData=!0));case 12:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),300)},watch:{"filter.tabActive":function(){this.search()},$route:function(){this._fetchData()}},data:function(){return{openType:"page",loading:!1,noMoreData:!1,orderList:[],filter:{tabActive:"vin",page:1,size:10,value:""}}}}},p5Qk:function(t,e,a){"use strict";var i=a("Xxa5"),n=a.n(i),r=a("exGp"),s=a.n(r),o=a("M4fF"),l=(a.n(o),a("oiih")),c=[{label:"全部",value:"0"},{label:"待补齐资料",value:l.b.WAIT_FILL_MATERIAL},{label:"待审核",value:l.b.WAIT_FOR_FIRST_CHECK},{label:"审核未通过",value:l.b.FISRT_CHECK_REJECTED},{label:"待物流验车",value:l.b.WAIT_FOR_CHECK_CAR},{label:"物流已验车",value:l.b.CHECK_PASSED},{label:"已发运",value:l.b.DISPATCHED},{label:"在途中",value:l.b.ON_THE_WAY},{label:"仓库验车不通过",value:l.b.STORE_CHECK_FAILED},{label:"已入库",value:l.b.PUT_IN_STORE},{label:"待提车",value:l.b.WAIT_FOR_PICK},{label:"已完成",value:l.b.PICK_SUCCESS},{label:"已取消",value:l.b.CLOSED}],u=[{label:"结算待支付",value:l.c.WAIT_FOR_PAY},{label:"待结算审核",value:l.c.CHECKING},{label:"还款审核通过",value:l.c.REJECT},{label:"审核通过",value:l.c.PASSED}],f=a.i(o.keyBy)(c,"value"),d=a.i(o.keyBy)(u,"value"),h={};e.a={filters:{orderStatusFormat:function(t){return f[t]?f[t].label:""},orderStatusClass:function(t){return h[t]||""},settlementStatusFormat:function(t){return d[t]?d[t].label:""}},methods:{closeOrder:function(t){var e=this;return s()(n.a.mark(function a(){var i;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.$confirm("确定取消订单？");case 2:i=a.sent,"confirm"===i&&(t.status=e.ORDER_STATUS_MAP.CLOSED);case 4:case"end":return a.stop()}},a,e)}))()},editOrder:function(t){console.log(t),this.$router.push({name:"orderEdit",params:{id:t.id}})},goToDetail:function(t){this.$router.push({name:"orderDetail",params:{id:t.id}})},canEditStatus:function(t){return a.i(o.includes)([l.b.WAIT_FILL_MATERIAL,l.b.WAIT_FOR_FIRST_CHECK],t)},canPickStatus:function(t){return a.i(o.includes)([l.b.PUT_IN_STORE],t)},canCloseStatus:function(t){return a.i(o.includes)([l.b.WAIT_FILL_MATERIAL,l.b.FISRT_CHECK_REJECTED,l.b.WAIT_FOR_CHECK_CAR,l.b.DISPATCHED],t)}},computed:{},data:function(){return{orderStatusList:c,orderStatusMap:f,settlementStatusList:u,settlementStatusMap:d}}}},tOwt:function(t,e,a){var i=a("KMIr");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("0155b6e9",i,!1)},uJ8L:function(t,e,a){a("tOwt");var i=a("VU/8")(a("WC8o"),a("50pe"),"data-v-f15f2e52",null);i.options.__file="/Users/luxueyan/work/kt-mhc-frontend/src/views/order/Search.vue",i.esModule&&Object.keys(i.esModule).some(function(t){return"default"!==t&&"__esModule"!==t})&&console.error("named exports are not supported in *.vue files."),i.options.functional&&console.error("[vue-loader] Search.vue: functional components are not supported with templates, they should use render functions."),t.exports=i.exports}});